<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="../../assets/css/book3.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
    integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
  <!-- nav bar starts -->
  <div class="menu-bar">
    <img src="../../assets/images/Screenshot__63_-removebg-preview.png" alt="logo">
    <ul class="main">
      <li class="dropdown"><a href="../../index.html">Home <i class="fas fa-caret-down"></i></a>
        <!-- <div class="dropdown-content">
          <ul>
            <li>
              <a href="#feature">Features</a>
            </li>

            <li>
              <a href="../../pages/review/review.html">Reviews</a>
            </li>
          </ul>
        </div> -->
      </li>
      <!-- <li><a href="#">For artist</a>
        <div class="dropdown-content">
          <ul>
            <li>
              <a href="./pages/upload/upload.html">Upload </a>
            </li>
        </div>
      </li> -->
      <li><a href="./pages/booking/start_booking.html">Book here</a></li>
      <!-- <li><a href="./pages/Login/login.html"> <i class="fa-solid fa-user"></i>login</a></li> -->
      <li><a href="../../pages/profile_of_user.html"> <img src="../../assets/images/IMG20200903161128.jpg" class="my-profile-img"></a>
      </li>

    </ul>
  </div>
  <!-- nav bar ends -->
  <!-- confirm booking content starts -->
  <div class="main-content">



    <div class="container">
      <h3 class="types">These are the types which are provided by this artist</h3>
      <!-- <div class="nude action">
      
          <img src="../../assets/images/nude makeup.avif" class="makeup">

    
        <p class="name">Nude Makeup</p>
      
      </div>

      <div class="HD action">
      
          <img src="../../assets/images/Hd makeup.webp" class="makeup">

   
        <p class="name">Hd Makeup</p>
    
      </div>

      <div class="dewy action">
       
          <img src="../../assets/images/dewy makwup.jpg" class="makeup">

 
        <p class="name">Dewy Makeup</p>

      </div>

      <div class="airbrush action">
     
          <img src="../../assets/images/dewy makwup.jpg" class="makeup">



  
        <p class="name">Airbrush Makeup</p>
    
      </div> -->

    </div>
    <!-- <form id="booking-form">

        <label for="name">Name:</label>
        <input type=" text" id="Name-of-coustomer" placeholder="Enter your name">
        <br><br>
        <label for="mail">Enter your email:</label>
        <input type="text" id="email-of-coustomer" placeholder="Enter your email">
        <br><br>
        <label for="number">Enter your phone-number:</label>
        <input type="number" id="contact-of-coustomer" placeholder="91..">
        <br><br>
        <label for="addres">Enter your address</label>
        <input type="text" id="address-coustomer">
        <br><br>
        <label for="date">Choose your date:</label>
        <input type="date" id="date-choosen-coustomer">
        <br><br>
        <label for="function"> Choose your function:</label>
        <br><br>
        <input type="checkbox" class="checkbox" id="bridal">
        <label for="function" class="function">
          Bridal
        </label>
        <br><br>
        <input type="checkbox" class="checkbox" id="Birthday">
        <label for="function" class="function">
          Birthday
        </label>
        <br>
        <br>
        <input type="checkbox" class="checkbox" id="Marriage">
        <label for="function" class="function">
          Marriage
        </label>
        <br><br>
        <input type="checkbox" class="checkbox" id="others">
        <label for="function" class="function">
          others
        </label>
        <br>
        <br>
        <button type="submit">confirm_booking</button>
      </form> -->




    <div class="event">


      <h3 class="types">Select the event</h3>
      <form id="booking-form">
        <div class="events_options">

          <div class="bridal user_choice">
            <input type="radio" name="group" value="Bridal" class="input">
            <label>Bridal</label>

          </div>
          <div class="baby_shower user_choice">

            <input type="radio" name="group" value="Babyshower" class="input">
            <label>Baby shower</label>
          </div>


          <div class="engagement user_choice">
            <input type="radio" name="group" value="Engagement" class="input">
            <label>Engegement</label>
          </div>

          <div class="puberty user_choice">
            <input type="radio" name="group" value="Puberty" class="input">
            <label>Puberty</label>
          </div>

          <div class="birthday user_choice">
            <input type="radio" name="group" value="Birthday" class="input">
            <label>Birthday party</label>
          </div>
          <div class="photoshoots user_choice">
            <input type="radio" name="group" value="Photoshoot" class="input">
            <label>Photoshoots</label>
          </div>
        </div>

    </div>

  </div>
  <div class="preferences">
    <div class="info">

      <div class="choice">
        <div class="Info_of_header">

          <h4>Choose Your preferences </h4>
          <p>Make your appoinment with Madhu Wonderfully</p>

          <div class="icons">
            <div class="makeup">
              <img src="../../assets/images/makeup (1).png" class="icons_booking">
              <h5>Makeup</h5>

            </div>
            <div class="hair">
              <img src="../../assets/images/hairstyle.png" class="icons_booking">
              <h5>Hairstyles</h5>
            </div>

          </div>

        </div>

        <div class="increment_decrement">
          <h3>Rate card</h3>
          <div class="count">
            <!-- <div class="count1 totla">
              <div class="title">
                <p class="method"> Saree drapping +Hd Makeup </p>
              </div>
              <div class="Plusminus">
                <i class="fa-solid fa-plus" id="plus"></i>
                <p class="quantity">0</p>        
                <i class="fa-solid fa-minus" id="minus"></i>
              </div>
              <div class="respective_cost">
                <i class="fa-solid fa-rupee-sign" id="sign"></i>
                <p id="res_cost">12000</p>
              </div>
            </div>
            <div class="count2 totla">
              <div class="title">
                <p class="method"> Saree drapping +Hd Makeup </p>
              </div>
              <div class="Plusminus">
                <i class="fa-solid fa-plus" id="plus"></i>
                <p class="quantity">0</p>        
                <i class="fa-solid fa-minus" id="minus"></i>
              </div>
              <div class="respective_cost">
                <i class="fa-solid fa-rupee-sign" id="sign"></i>
                <p id="res_cost">12000</p>
              </div>
            </div> -->

          </div>
        </div>
      </div>
      <div class="booking_details">

        <h3>Book Your Booking now!!</h3>



        <div class="name_num  inputs">
          <div class="cus_name">

            <i class="fa-sharp fa-solid fa-user"></i>

            <input type="text" placeholder="Name" id="Name-of-customer">
          </div>
          <div class="cus_num">
            <i class="fa-solid fa-mobile-screen"></i>
            <input type="number" placeholder="Mobile number" id="contact-of-customer">
          </div>


        </div>



        <div class="cus_address inputs">

          <i class="fa-solid fa-location-dot"></i>
          <input type="text" placeholder="Address" id="address-customer">

        </div>
        <div class="door_num inputs">
          <i class="fa-solid fa-door-open"></i>
          <input type="text" placeholder="Door Number">

        </div>


        <div class="date_time inputs">

          <div class="date">
            <i class="fa-solid fa-calendar-days"></i>
            <input type="date" placeholder="Date" id="date-choosen-customer">

          </div>
          <div class="time inputs">

            <i class="fa-solid fa-clock"></i>
            <input type="time" placeholder="Time" id="Time-choosen-customer">

          </div>



        </div>


        <div class="selected_option inputs">
          <i class="fa-solid fa-indian-rupee-sign " id="rupee"></i>
          <label>Selected option</label>
          <input type="text">
        </div>

        <h4>Total Amount : <i class="fa-solid fa-indian-rupee-sign"></i><span id="total-amount"></span></h4>
        <button type="submit">Book now</button>

      </div>


      </form>


    </div>

  </div>


  <div id="popup-container">
    <div id="popup-message">
      <h3>Your booking successfully completed</h3>
    </div>
    <button id="close-button">Close</button>
  </div>

  </div>


  <script>
    let url = window.location.search;  //?name=Bridal MAkeup by sharmila
    let urls = new URLSearchParams(url)
    let name = urls.get("book_name");

    console.log(name)

    const radioButtons = document.getElementsByName("group");
    let selectedValue
    for (let i = 0; i < radioButtons.length; i++) {
      radioButtons[i].addEventListener("click", function () {
        if (this.checked) {
          selectedValue = this.value;

        }
      });
    }



    let form_filled = document.getElementById("booking-form")
    form_filled.addEventListener('submit', e => {
      e.preventDefault();

      let data_of_cus = JSON.parse(localStorage.getItem("data"));
      let dataofartist = JSON.parse(localStorage.getItem("card_data"));/*registered information of artist with thier nama an so on*/
      let active_user = localStorage.getItem("profile").value /* active login of artist email*/

      const value = selectedValue
      const option = selectedOptions
      const totla = selectedTotalCost
      // getting the information form the user*/
      const name_client = document.getElementById("Name-of-customer").value

      const contact_client = document.getElementById("contact-of-customer").value
      const addres_client = document.getElementById("address-customer").value
      const date_event_client = document.getElementById("date-choosen-customer").value
      const time_client = document.getElementById("Time-choosen-customer").value
const address=document.getElementById("address-customer").value

      const emailofcus = localStorage.getItem("profile")
      console.log(emailofcus)
      const booking_info = JSON.parse(localStorage.getItem("records_booking_clients"))
      if ((name_client.trim() != "") && (time_client.trim() != "") && (contact_client.trim() != "") && (addres_client.trim() != "") && (date_event_client.trim() != "") && value) {
        let records_booking_clients = JSON.parse(localStorage.getItem("records_booking_clients")) ? JSON.parse(localStorage.getItem("records_booking_clients")) : []
        let object_booking_records = {
          "customer_name": name_client,
          "customer_email": emailofcus,
          "customer_contact": contact_client,
          "customer_address": addres_client,
          "event_date": date_event_client,
          "time": time_client,
          "status": false,
          "selected_event": value,
          "se": option,
          "totla_cost": totla,
          "location":address,
          "id": records_booking_clients.length,
          "selected_artist_for_booking": name /*store the object of form filled by user with selected artist name*/
        }
        records_booking_clients.push(object_booking_records);
        // console.log(records_booking_clients)





        localStorage.setItem("records_booking_clients", JSON.stringify(records_booking_clients));



        // Add booking info to artist's data
        let artist = dataofartist.find((obj) => obj.name === name);
        artist.booking_records= records_booking_clients.filter(element => element.selected_artist_for_booking === artist.name);

        // Add booking info to customer's data
        let customer = data_of_cus.find((obj) => obj.user_email === emailofcus);
        customer.booking_record= records_booking_clients.filter(element => element.customer_email === emailofcus);


        localStorage.setItem("card_data", JSON.stringify(dataofartist));
        localStorage.setItem("data", JSON.stringify(data_of_cus));

    

        const successMessage = `Booking successful! Have a great day with ${object_booking_records.selected_artist_for_booking}`;
        const popupContainer = document.getElementById('popup-container');
        const popupMessage = document.getElementById('popup-message');
        popupMessage.textContent = successMessage;
        popupContainer.style.display = 'block';



      }
      else {
        alert("Fill the required data")

      }
    })






    let dataofartist = JSON.parse(localStorage.getItem("card_data"))
    let user = dataofartist.find(obj => obj.name === name);
    user.services.filter(function (obj) {
      listing(obj)

    });



    function listing(e) {
      let container = document.querySelector(".container");
      let imgSrc;

      if (e.category == 'Nude') {
        imgSrc = "../../assets/images/nude makeup.avif"
      }
      else if (e.category === 'Hd') {
        imgSrc = "../../assets/images/Hd makeup.webp"

      }
      else if (e.category === 'Matte') {
        imgSrc = "../../assets/images/Mattee.jpg"

      }
      else if (e.category === 'Airbrush') {
        imgSrc = "../../assets/images/air brush.jpg"

      }
      else if (e.category === 'Dewy') {
        imgSrc = "../../assets/images/dewy makwup.jpg"

      }
      else if (e.category === 'Editorial') {
        imgSrc = "../../assets/images/Editorial Makeup Looks.jpeg"

      }
      else if (e.category === 'celebirity') {
        imgSrc = "../../assets/images/celebirity makeup.jpeg"

      }
      else if (e.category === 'Natural') {
        imgSrc = "../../assets/images/Natural Makeup.jpeg"

      }
      else if (e.category === 'Permanent') {
        imgSrc = "../../assets/images/permanent Makeup.jpeg"

      }
      else if (e.category === 'shymmery') {
        imgSrc = "../../assets/images/shymmery.jpeg"

      }

      container.innerHTML += `
    <div class="action">
      <img src="${imgSrc}" class="Makeup">
      <p class="name">${e.category}</p>
    </div>
  `;
    }





    let artist = dataofartist.find(obj => obj.name === name);
    if (artist.packages && artist.packages.length > 0) {
      artist.packages.forEach(function (package) {
        showingpackage(package);
      });
    }




    let selectedOptions = [];
    let selectedTotalCost = 0;

    function showingpackage(package) {
      let show = document.querySelector(".count");
      let total = 0;

      const packageKeys = Object.keys(package)
        .filter(key => package[key] !== "" && package[key] !== undefined)
        .slice(0, -3);

      for (const key of packageKeys) {
        let html = `
      <div class="count1 total">
        <div class="title">
          <p class="method">${key}</p>
        </div>
        <div class="Plusminus">
          <i class="fa-solid fa-plus" id="plus"></i>
          <p class="quantity">0</p>        
          <i class="fa-solid fa-minus" id="minus"></i>
        </div>
        <div class="respective_cost">
          <i class="fa-solid fa-rupee-sign" id="sign"></i>
          <p class="cost" id="res_cost_${key}">${package[key]}</p>
        </div>
      </div>
    `;

        show.innerHTML += html;
      }

      // Select all plus and minus buttons
      const plusBtns = document.querySelectorAll('.fa-plus');
      const minusBtns = document.querySelectorAll('.fa-minus');
      const countElements = document.querySelectorAll('.quantity');
      const costElements = document.querySelectorAll('.cost');

      // Define a count array to store counts for each element
      let counts = Array.from({ length: plusBtns.length }, () => 0);

      // Define a cost array to store costs for each element
      const cost = packageKeys.map((key) => {
        return parseInt(package[key]);
      });

      let costs = Array.from(
        { length: plusBtns.length }
        , (_, i) => cost[i]);

      // Loop through each button and add event listener
      for (let i = 0; i < plusBtns.length; i++) {
        plusBtns[i].addEventListener('click', () => {
          incrementCount(i);
        });
        minusBtns[i].addEventListener('click', () => {
          decrementCount(i);
        });
      }

      // Define functions to update the count and cost for a specific index
      function incrementCount(index) {
        counts[index]++;
        updateCountAndCost(index);
      }

      function decrementCount(index) {
        if (counts[index] > 0) {
          counts[index]--;
          updateCountAndCost(index);
        }
      }

      function updateCountAndCost(index) {
        const countElement = countElements[index];
        const costElement = costElements[index];
        const totalCost = counts[index] * costs[index];

        countElement.textContent = counts[index];
        costElement.textContent = totalCost;

        // Get the selected options
        selectedOptions = packageKeys.filter((key, i) => counts[i] > 0);

        // Get the total cost of the selected options
        selectedTotalCost = selectedOptions.reduce((acc, key) => {
          return acc + counts[packageKeys.indexOf(key)] * parseInt(package[key]);
        }, 0);

        // Update the input element with the selected options
        const inputElement = document.querySelector('.selected_option input');
        inputElement.value = selectedOptions.join(', ');

        // Update the h4 element with the total cost
        const totalAmountElement = document.querySelector('h4 .fa-indian-rupee-sign');
        totalAmountElement.nextElementSibling.textContent = selectedTotalCost;
      }



    }

    let option = selectedOptions
    console.log(option)




    const closeButton = document.getElementById('close-button');
    closeButton.addEventListener('click', function () {
      const popupContainer = document.getElementById('popup-container');
      popupContainer.style.display = 'none';
      window.location.href = "../../pages/booking/book4.html"
    });




  </script>
</body>

</html>
<!-- confirm booking content ends 